FUNCTION "osr.edw.staging.rms::TF_DFACTS_MUL_VAL" ( )
       RETURNS TABLE (
    	CLIENT  		NVARCHAR(3),
		OBART			NVARCHAR(2),
		OBJID			NVARCHAR(20),
		FACT_TYPE_SEQ	NVARCHAR(4),
		FACT_TYPE_REP	NVARCHAR(4),
		FACT_CAT_SEQ	NVARCHAR(2),
		FACT_CAT_REP	NVARCHAR(4),
		VALID_TO		NVARCHAR(15),
		VALID_FROM		NVARCHAR(15),
		FACT_SET		NVARCHAR(6),
		FACT_TYPE		NVARCHAR(4),
		FACT_CATEGORY	NVARCHAR(4), 
		VALUE_GENERIC   NVARCHAR(40),
		QUAL_GENERIC    NVARCHAR(40),
		OBJNR           NVARCHAR(22)
       )
       LANGUAGE SQLSCRIPT 
       SQL SECURITY INVOKER AS 
BEGIN 
/*****************************  
       Write your function logic 
 *****************************/ 
 RETURN
 SELECT 
dfacts_typ.client AS CLIENT,
dfacts_typ.obart AS OBART,
dfacts_typ.objid AS OBJID,
dfacts_typ.fact_type_seq AS FACT_TYPE_SEQ,
dfacts_typ.fact_type_rep AS FACT_TYPE_REP,
TFACT_TYPEPART.fact_cat_seq AS FACT_CAT_SEQ,
dfacts_typ.FACT_CAT_REP AS FACT_CAT_REP,
dfacts_typ.valid_to AS VALID_TO,
dfacts_typ.valid_from AS VALID_FROM,
dfacts_typ.fact_set AS FACT_SET,
TFACT_TYPEPART.fact_type AS FACT_TYPE,
TFACT_TYPEPART.fact_category AS FACT_CATEGORY, 
dfacts_typ.VALUE_GENERIC as VALUE_GENERIC,
dfacts_typ.QUAL_GENERIC as QUAL_GENERIC,
dfacts_typ.OBJNR as OBJNR
FROM 
"osr.edw.staging.md.rms::CDS_PSCD.DSO.DFACTS.active_data"
AS dfacts_typ
RIGHT OUTER JOIN
"osr.edw.staging.md.rms::CDS_PSCD.DSO.TFACT_TYPEPART.active_data"
AS TFACT_TYPEPART
on  dfacts_typ.client = TFACT_TYPEPART.client
and dfacts_typ.fact_type = TFACT_TYPEPART.fact_type
and dfacts_typ.FACT_CAT_SEQ = TFACT_TYPEPART.FACT_CAT_SEQ
where tfact_typepart.MULTIPLE  = 'X';

END;